---
title: "Globales Plastik"
description: |
  Plastik Global
site: distill::distill_website
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(dplyr)
library(colorspace)
library(ggthemes)
library(psych)
library(cowplot)
library(plotly)
library(ggiraph)

```

```{r}
# Fine-Tuning muss noch gemacht werden
# Plott so an sich zu langweilig? Können wir noch andere Date hier verknüpfen? 
# Gibt es eine Möglichkeit die lineare und die kumultaive ENtwicklung in einem Plot dazustellen?

global_plastic <- readr::read_csv("data/global-plastics-production.csv")

global_plastic %>% rename(gpp = `Global plastics production (million tonnes)`) -> global_plastic

global_plastic %>%
 mutate(gpp = as.numeric(gpp)/1000000) %>%
ggplot(aes(x = Year, y = gpp )) + geom_line(color = '#00868B', alpha = 0.6) + geom_point_interactive(aes(data_id = gpp, tooltip = gpp), color = '#00868B') +
  scale_x_continuous(limits = c(1950, 2015), breaks = c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2015), expand = c(0.02,0.02)) +
  scale_y_continuous(limits = c(0, 400), breaks = c(0, 50, 100, 150, 200, 250, 300, 350, 400), expand = c(0,0)) +
  labs(x = "", y = "Plastik in Millionen Tonnen", title = "Globale Entwicklung der Plastik Produktion von 1950 bis 2015") +
  theme_minimal_hgrid(12) -> plot_global_plastic

girafe(
  ggobj = plot_global_plastic,
  width_svg = 7,
  height_svg = 7*0.618,
    options = list(
    opts_tooltip(css = "background: #00868B; color: #FFFFFF;padding:2px;border-radius:2px;")))


#2. Versuch interaktive Grafik mit Hover-Text

global_plastic %>%
 mutate(gpp = as.numeric(gpp)/1000000) -> global_plastic2


global_plastic2 %>%
plot_ly(x=~Year, y=~gpp, type = "scatter", mode = "markers", hoverinfo = "text", text = paste("Year: ", global_plastic2$Year, "<br>", "Plastic in million tonnes: ", global_plastic2$gpp)) ->plot1

x <- list(
  title = "")
y <- list(
  title = "Globale Plastikproduktion in mio. Tonnen")

plot2 <- plot1 %>% layout(xaxis = x, yaxis = y)

plot2
```

```{r}
cumulative_global_plastic <- readr::read_csv("data/cumulative-global-plastics.csv")

cumulative_global_plastic %>%
  rename(cgpp = `Cumulative global plastics production (million tonnes)`) %>%
 mutate(cgpp = as.numeric(cgpp)/1000000000) %>%
ggplot(aes(x = Year, y = cgpp )) + geom_area(fill = '#00868B', alpha= 0.6) + geom_point_interactive(aes(data_id = cgpp, tooltip = cgpp), color = '#00868B') +
  scale_x_continuous(limits = c(1950, 2015), breaks = c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2015), expand = c(0.02, 0.02)) +
  scale_y_continuous(limits = c(0, 8), breaks = c(0, 1, 2, 3, 4, 5, 6, 7, 8), expand = c(0,0)) +
  labs(x = "", y = "Plastik in Milliarden Tonnen", title = "Kumulation  der globalen Plastikproduktion von 1950 bis 2015") +
  theme_minimal_hgrid(12) -> plot_cumulative_global_plastic

girafe(
  ggobj = plot_cumulative_global_plastic,
  width_svg = 7,
  height_svg = 7*0.618,
    options = list(
    opts_tooltip(css = "background: #00868B; color: #FFFF; padding:2px;border-radius:2px;")))
```

```{r}

#per_capita_plastic_waste <- readr::read_csv("data/per-capita-plastic-waste-vs-gdp-per-capita.csv")
#per_capita_mismanaged_plastic <- readr::read_csv("data/per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv")

#Kombinieren der beiden Datensätze mit per Capita plastic waste und per capita mismanaged plastic
#combi <- inner_join(per_capita_mismanaged_plastic, per_capita_plastic_waste)

#CSV Datei wurde um die Spalte Kontinent ergänzt, gefiltert auf das Jahr 2010  und wird nun neu eingelesen
data_final<- readr::read_csv("data/data_cleaned.csv") %>%
  na.omit() -> mydata

mydata %>%
  rename(BIP = `GDP`, Kontinent = 'Continent') %>%
  select(Entity, `Per capita mismanaged plastic waste`, `Per capita plastic waste (kg/person/day)`, BIP, Kontinent) -> mydata2

mydata2 %>%
  ggplot(aes(x = `Per capita plastic waste (kg/person/day)`, y = `Per capita mismanaged plastic waste`, size = BIP, color = Kontinent)) + geom_point_interactive(position = "jitter", aes(data_id = Entity, tooltip = Entity)) +                                                 scale_x_continuous(limits = c(0, 0.7), breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7)) +
  scale_y_continuous(limits = c(0, 0.3), breaks = c(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3)) +
  theme_minimal_grid() +
  theme(axis.text.y = element_text(vjust = 0)) +
  scale_colour_brewer(palette = "Set1") +
  labs(x = "Plastikmüll pro Kopf (täglich in kg)", y = "Inadäquat entsorgter Plastikmüll pro Kopf (täglich in kg)", title = "Zusammenhang von Wolstand, Plastikmüllproduktion \nund inadäquater Entsorgung") -> plot_per_capita_waste_mismanagement_GDP


girafe(
  ggobj = plot_per_capita_waste_mismanagement_GDP,
  width_svg = 9,
  height_svg = 9*0.618,
    options = list(
    opts_tooltip(opacity = .7, css = "background-color:gray;color:white;padding:2px;border-radius:2px;"),
    opts_hover(css = "fill: #00868B;"),
    opts_hover_inv(css = "opacity: 0.3;")))

RColorBrewer::display.brewer.all()


#Definition inadäquate Entsorgung auf Website ergänzen + Info das Daten aus 2010 sind 

```

